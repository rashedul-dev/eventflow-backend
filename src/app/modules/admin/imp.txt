// ============================================================================
// INTEGRATION GUIDE & USAGE
// ============================================================================

/*
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  ğŸ” ADMIN MANAGEMENT SYSTEM - SETUP GUIDE                 â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¦ STEP 1: Add to app.ts
-------------------------
import adminRoutes from "./app/modules/admin/admin.routes"

app.use("/api/v1/admin", adminRoutes)


ğŸ”‘ STEP 2: Role-Based Access
------------------------------
All admin routes require ADMIN or SUPER_ADMIN role.
Routes automatically enforce this via auth middleware.


ğŸ“Š ADMIN FEATURES
------------------

1. EVENT VERIFICATION DASHBOARD
   âœ… View all pending events
   âœ… Approve/Reject events with reasons
   âœ… View verification statistics
   âœ… Audit trail of all verifications

2. USER MANAGEMENT
   âœ… Search/filter all users
   âœ… Suspend/Activate users
   âœ… Verify email/phone
   âœ… Update user roles
   âœ… View user statistics
   âœ… Audit trail of all actions

3. PLATFORM ANALYTICS
   âœ… Total users/events/revenue
   âœ… Active/pending events count
   âœ… User growth over time
   âœ… Top events by revenue
   âœ… Top organizers by revenue
   âœ… Custom date ranges

4. COMMISSION REPORTS
   âœ… Total revenue/commission/payout
   âœ… Commission by event
   âœ… Commission by organizer
   âœ… Custom date ranges
   âœ… Export-ready data


ğŸŒ API ENDPOINTS
-----------------

EVENT VERIFICATION:
GET    /api/v1/admin/events/pending                  # Get pending events
POST   /api/v1/admin/events/:id/verify               # Approve/Reject
GET    /api/v1/admin/events/verification-stats       # Statistics

USER MANAGEMENT:
GET    /api/v1/admin/users                           # Get all users
POST   /api/v1/admin/users/:id/manage                # Manage user
GET    /api/v1/admin/users/statistics                # User stats

ANALYTICS:
GET    /api/v1/admin/analytics                       # Platform analytics
  ?period=week|month|quarter|year|custom
  &dateFrom=2024-01-01
  &dateTo=2024-12-31

COMMISSION REPORTS:
GET    /api/v1/admin/reports/commission              # Commission report
  ?dateFrom=2024-01-01
  &dateTo=2024-12-31
  &organizerId=user_123
  &eventId=evt_456


ğŸ’» USAGE EXAMPLES
------------------

1. APPROVE EVENT
----------------
POST /api/v1/admin/events/:id/verify
{
  "status": "APPROVED"
}

2. REJECT EVENT
---------------
POST /api/v1/admin/events/:id/verify
{
  "status": "REJECTED",
  "rejectionReason": "Event does not meet community guidelines. Please review and resubmit."
}

3. SUSPEND USER
---------------
POST /api/v1/admin/users/:id/manage
{
  "action": "suspend",
  "reason": "Violation of terms of service - spam events"
}

4. VERIFY USER EMAIL
--------------------
POST /api/v1/admin/users/:id/manage
{
  "action": "verify_email"
}

5. UPDATE USER ROLE
-------------------
POST /api/v1/admin/users/:id/manage
{
  "action": "update_role",
  "newRole": "ORGANIZER"
}

6. GET PLATFORM ANALYTICS (Last Month)
---------------------------------------
GET /api/v1/admin/analytics?period=month

Response:
{
  "overview": {
    "totalUsers": 1250,
    "totalEvents": 450,
    "totalRevenue": 125000.00,
    "totalCommission": 6250.00,
    "activeEvents": 85,
    "pendingEvents": 12
  },
  "topEvents": [...],
  "topOrganizers": [...],
  "userGrowth": [...]
}

7. GET COMMISSION REPORT (Q1 2024)
----------------------------------
GET /api/v1/admin/reports/commission?dateFrom=2024-01-01&dateTo=2024-03-31

Response:
{
  "summary": {
    "totalRevenue": 450000.00,
    "totalCommission": 22500.00,
    "totalPayout": 427500.00,
    "transactionCount": 1250
  },
  "byEvent": [...],
  "byOrganizer": [...]
}


ğŸ”’ SECURITY FEATURES
---------------------
âœ… Role-based access control (ADMIN/SUPER_ADMIN only)
âœ… Audit trail for all admin actions
âœ… Cannot manage SUPER_ADMIN users
âœ… Revoke refresh tokens on user suspension
âœ… Detailed logging of all operations


ğŸ“‹ PERMISSIONS
---------------
SUPER_ADMIN: All permissions
ADMIN: Limited permissions (cannot delete, adjust commissions)

Event Management:
- approve_events
- reject_events
- delete_events (SUPER_ADMIN only)

User Management:
- suspend_users
- verify_users
- delete_users (SUPER_ADMIN only)
- update_user_roles

Financial:
- view_financials
- process_refunds
- view_commission_reports
- adjust_commissions (SUPER_ADMIN only)

Platform:
- view_analytics
- manage_settings (SUPER_ADMIN only)
- view_audit_logs


ğŸ“Š ANALYTICS PERIODS
---------------------
- today: Last 24 hours
- week: Last 7 days
- month: Last 30 days
- quarter: Last 90 days
- year: Last 365 days
- custom: Specify dateFrom and dateTo


ğŸ¨ FRONTEND INTEGRATION EXAMPLE
---------------------------------
// Approve Event
const approveEvent = async (eventId: string) => {
  const response = await fetch(`/api/v1/admin/events/${eventId}/verify`, {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${adminToken}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({ status: 'APPROVED' })
  })
  return response.json()
}

// Suspend User
const suspendUser = async (userId: string, reason: string) => {
  const response = await fetch(`/api/v1/admin/users/${userId}/manage`, {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${adminToken}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      action: 'suspend',
      reason
    })
  })
  return response.json()
}

// Get Analytics
const getAnalytics = async (period: string) => {
  const response = await fetch(`/api/v1/admin/analytics?period=${period}`, {
    headers: {
      'Authorization': `Bearer ${adminToken}`
    }
  })
  return response.json()
}


ğŸ” AUDIT TRAIL
---------------
All admin actions are logged in the audit_logs table:
- userId: Admin who performed the action
- action: Type of action (APPROVE_EVENT, SUSPEND_USER, etc.)
- entity: Entity type (Event, User, etc.)
- entityId: ID of affected entity
- oldValues: Previous state
- newValues: New state
- timestamp: When action occurred

Query audit logs:
SELECT * FROM audit_logs
WHERE entity = 'Event'
AND action = 'APPROVE_EVENT'
ORDER BY created_at DESC;


ğŸ“ˆ DASHBOARD METRICS
---------------------
Key metrics available for admin dashboard:

User Metrics:
- Total users
- Active users
- Verified users
- Suspended users
- User growth trend

Event Metrics:
- Total events
- Active events
- Pending approval
- Approval rate
- Rejection rate

Financial Metrics:
- Total revenue
- Platform commission
- Organizer payouts
- Average commission rate

Performance Metrics:
- Top performing events
- Top organizers
- Revenue by period
- Ticket sales trends


ğŸš¨ IMPORTANT NOTES
-------------------
1. SUPER_ADMIN users cannot be suspended or deleted
2. User suspension automatically revokes all active sessions
3. Event rejection requires a detailed reason
4. All actions are logged in audit_logs table
5. Commission reports can be filtered by date/organizer/event
6. Analytics data is cached for performance (5 min TTL)


âœ… TESTING CHECKLIST
---------------------
â–¡ Admin can view pending events
â–¡ Admin can approve events
â–¡ Admin can reject events with reason
â–¡ Admin can view all users
â–¡ Admin can suspend users
â–¡ Admin can verify user emails
â–¡ Admin can update user roles
â–¡ Cannot manage SUPER_ADMIN users
â–¡ Suspended users are logged out
â–¡ Audit trail is created
â–¡ Analytics returns correct data
â–¡ Commission reports are accurate
â–¡ Date range filtering works
â–¡ Unauthorized access is blocked


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              ğŸ‰ ADMIN MANAGEMENT SYSTEM READY TO USE!                     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
*/